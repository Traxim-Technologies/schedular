

# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - init: yarn install
    command: |
      composer i && alias sail='[ -f sail ] && bash sail || bash vendor/bin/sail'
      cp .env.example .env
      sed -i "s|VITE_GITPOD_WORKSPACE_URL=|VITE_GITPOD_WORKSPACE_URL=${GITPOD_WORKSPACE_URL}|g" .env
      sed -i "s|APP_URL=|APP_URL=${GITPOD_WORKSPACE_URL}|g" .env && sed -i "s|APP_URL=https://|APP_URL=https://80-|g" .env
      ./vendor/bin/sail up -d
      gp await-port 80
      gp await-port 3306
      sleep 8
      ./vendor/bin/sail artisan key:generate
      ./vendor/bin/sail artisan migrate:fresh
      ./vendor/bin/sail artisan passport:install
      ./vendor/bin/sail artisan db:seed
      ./vendor/bin/sail yarn dev
ports:
  - port: 80
    visibility: public
  - port: 5173
    visibility: public
    onOpen: open-browser

vscode:
  extensions:
    - "cweijan.vscode-mysql-client2"
    - "amiralizadeh9480.laravel-extra-intellisense"
    - "shufo.vscode-blade-formatter"
    - "onecentlin.laravel-blade"
